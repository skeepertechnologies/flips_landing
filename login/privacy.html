<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Privacy Policy | FLIPS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.12.1/font/bootstrap-icons.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #f0f2f8, #e6e9f0);
            font-family: Candara, sans-serif;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
            position: relative;
        }
        .card {
            width: 100%;
            max-width: 600px;
            border-radius: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 2;
            margin: 2rem 0;
        }
        .card-title {
            font-weight: bold;
            color: #7b4d11;
        }
        .btn-primary {
            background-color: #7b4d11;
            border-color: #7b4d11;
            border-radius: 0;
            font-weight: bold;
        }
        .btn-primary:hover {
            background-color: #5c3a0d;
            border-color: #5c3a0d;
        }
        .btn-outline-primary {
            border-color: #7b4d11;
            color: #7b4d11;
            border-radius: 0;
            font-weight: bold;
        }
        .btn-outline-primary:hover {
            background-color: #7b4d11;
            color: white;
        }
        .alert-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .alert {
            border-radius: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        h2, h3 {
            color: #7b4d11;
        }
        p, li {
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .policy-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 1rem;
        }
    </style>
</head>
<body>
    <!-- Blurred Background Video -->
    <video autoplay muted loop playsinline class="position-fixed w-100 h-100 object-fit-cover z-n1" style="filter: blur(4px); transform: scale(1.05);">
        <source src="../assets/video/bg.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Privacy Policy Card -->
    <div class="card shadow-lg p-4">
        <div class="card-body">
            <div class="d-flex align-items-center justify-content-center mb-4">
                <img src="../assets/img/logo.png" alt="FLIPS" style="height: 40px;">
            </div>
            <h6 class="card-title mb-4 text-center">FLIPS Privacy Policy</h6>
            <div class="policy-content" role="region" aria-labelledby="privacy-policy-heading">
                <h2 id="privacy-policy-heading">Privacy Policy</h2>
                <p><strong>Last Updated: May 13, 2025</strong></p>
                <p>At FLIPS, we are committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, share, and protect your data when you use our platform and services.</p>

                <h3>1. Information We Collect</h3>
                <p>We collect information to provide and improve our services. The types of information we collect include:</p>
                <ul>
                    <li><strong>Personal Information</strong>: When you register, we collect your username, email address, first name, last name, and phone number (if provided).</li>
                    <li><strong>Profile Information</strong>: You may provide additional details such as profile picture, billing address, bio, and subscription preferences.</li>
                    <li><strong>Usage Data</strong>: We collect information about how you interact with our platform, including IP address, browser type, pages visited, and timestamps.</li>
                    <li><strong>Cookies and Tracking</strong>: We use cookies to enhance your experience, analyze usage, and personalize content. You can manage cookie preferences in your browser settings.</li>
                </ul>

                <h3>2. How We Use Your Information</h3>
                <p>Your information is used to:</p>
                <ul>
                    <li>Provide and maintain our services, including user authentication and profile management.</li>
                    <li>Personalize your experience and deliver relevant content.</li>
                    <li>Communicate with you, including sending account-related notifications and responding to inquiries.</li>
                    <li>Analyze usage to improve our platform and ensure security.</li>
                    <li>Comply with legal obligations and protect our rights.</li>
                </ul>

                <h3>3. Sharing Your Information</h3>
                <p>We do not sell your personal information. We may share your data:</p>
                <ul>
                    <li>With service providers who assist us in operating our platform (e.g., email delivery services), under strict confidentiality agreements.</li>
                    <li>To comply with legal requirements, such as responding to subpoenas or government requests.</li>
                    <li>In the event of a merger, acquisition, or sale of assets, with appropriate safeguards.</li>
                </ul>

                <h3>4. Your Rights and Choices</h3>
                <p>You have the right to:</p>
                <ul>
                    <li>Access, update, or delete your personal information via your account settings.</li>
                    <li>Opt out of marketing communications by following unsubscribe instructions in emails.</li>
                    <li>Disable cookies through your browser settings, though this may affect functionality.</li>
                    <li>Request a copy of your data or object to its processing by contacting us.</li>
                </ul>

                <h3>5. Data Security</h3>
                <p>We implement industry-standard measures to protect your data, including encryption, secure servers, and access controls. However, no system is completely secure, and we cannot guarantee absolute security.</p>

                <h3>6. Data Retention</h3>
                <p>We retain your information for as long as your account is active or as needed to provide services. You can request account deletion, after which we will remove your data, except as required by law.</p>

                <h3>7. Childrenâ€™s Privacy</h3>
                <p>FLIPS is not intended for users under 13. We do not knowingly collect data from children. If you believe we have collected such data, please contact us to have it removed.</p>

                <h3>8. International Data Transfers</h3>
                <p>Your data may be transferred to and processed in countries other than your own. We ensure appropriate safeguards are in place to protect your information.</p>

                <h3>9. Changes to This Policy</h3>
                <p>We may update this Privacy Policy to reflect changes in our practices or legal requirements. We will notify you of significant changes via email or a notice on our platform.</p>

                <h3>10. Contact Us</h3>
                <p>If you have questions or concerns about this Privacy Policy, please contact us at:</p>
                <ul>
                    <li>Email: support@flipsintel.org</li>
                    <li>Address: FLIPS, 123 Innovation Drive, Nairobi, Kenya</li>
                </ul>
            </div>
            <button class="btn btn-primary w-100 mt-4" id="acceptPolicyBtn">Accept Privacy Policy</button>
            <a href="login.html" class="btn btn-outline-primary w-100 mt-3">Back to Login</a>
        </div>
    </div>

    <!-- Alert Container -->
    <div class="alert-container" id="alertContainer">
        <div class="alert alert-success alert-dismissible fade d-none" id="successAlert" role="alert">
            <strong>Success!</strong> Privacy policy accepted.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <div class="alert alert-danger alert-dismissible fade d-none" id="errorAlert" role="alert">
            <strong>Error!</strong> Failed to accept privacy policy. Please try again.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <div class="alert alert-warning alert-dismissible fade d-none" id="authAlert" role="alert">
            <strong>Login Required!</strong> Please log in to accept the privacy policy.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        const BASE_URL = 'https://api.flipsintel.org';

        // Get CSRF token from cookies
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Show alert
        function showAlert(alertId, message) {
            const alerts = ['successAlert', 'errorAlert', 'authAlert'];
            alerts.forEach(id => {
                const alert = document.getElementById(id);
                alert.classList.add('d-none');
                alert.classList.remove('show');
            });

            const targetAlert = document.getElementById(alertId);
            if (message) {
                targetAlert.querySelector('strong').nextSibling.textContent = ` ${message}`;
            }
            targetAlert.classList.remove('d-none');
            targetAlert.classList.add('show');
            if (alertId === 'successAlert') {
                setTimeout(() => {
                    window.location.href = '../dashboard/index.html';
                }, 2000);
            } else if (alertId === 'authAlert') {
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 2000);
            } else {
                setTimeout(() => {
                    targetAlert.classList.remove('show');
                    setTimeout(() => targetAlert.classList.add('d-none'), 150);
                }, 5000);
            }
        }

        // Handle Accept button click
        document.getElementById('acceptPolicyBtn').addEventListener('click', async function () {
            const token = localStorage.getItem('token');
            if (!token) {
                showAlert('authAlert', 'Please log in to accept the privacy policy.');
                return;
            }

            this.disabled = true;
            this.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Accepting...';

            try {
                const response = await axios.post(`${BASE_URL}/userprofile/accept-privacy-policy/`, {}, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-CSRFToken': getCookie('csrftoken')
                    }
                });
                console.log('Privacy policy accepted:', response.data);
                showAlert('successAlert');
            } catch (error) {
                console.error('Failed to accept privacy policy:', error.response ? error.response.data : error.message);
                const errorMessage = error.response?.data?.error || 'Failed to accept privacy policy. Please try again.';
                showAlert('errorAlert', errorMessage);
            } finally {
                this.disabled = false;
                this.innerHTML = 'Accept Privacy Policy';
            }
        });
    </script>
</body>
</html>